!function(){function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var n,a,r="function"==typeof Symbol?Symbol:{},l=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(e,r,l,o){var i=r&&r.prototype instanceof u?r:u,c=Object.create(i.prototype);return t(c,"_invoke",function(e,t,r){var l,o,i,u=0,c=r||[],d=!1,p={p:0,n:0,v:n,a:f,f:f.bind(n,4),d:function(e,t){return l=e,o=0,i=n,p.n=t,s}};function f(e,t){for(o=e,i=t,a=0;!d&&u&&!r&&a<c.length;a++){var r,l=c[a],f=p.p,b=l[2];e>3?(r=b===t)&&(i=l[(o=l[4])?5:(o=3,3)],l[4]=l[5]=n):l[0]<=f&&((r=e<2&&f<l[1])?(o=0,p.v=t,p.n=l[1]):f<b&&(r=e<3||l[0]>t||t>b)&&(l[4]=e,l[5]=t,p.n=b,o=0))}if(r||e>1)return s;throw d=!0,t}return function(r,c,b){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&f(c,b),o=c,i=b;(a=o<2?n:i)||!d;){l||(o?o<3?(o>1&&(p.n=-1),f(o,i)):p.n=i:p.v=i);try{if(u=2,l){if(o||(r="next"),a=l[r]){if(!(a=a.call(l,i)))throw TypeError("iterator result is not an object");if(!a.done)return a;i=a.value,o<2&&(o=0)}else 1===o&&(a=l.return)&&a.call(l),o<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),o=1);l=n}else if((a=(d=p.n<0)?i:e.call(t,p))!==s)break}catch(a){l=n,o=1,i=a}finally{u=1}}return{value:a,done:d}}}(e,l,o),!0),c}var s={};function u(){}function c(){}function d(){}a=Object.getPrototypeOf;var p=[][l]?a(a([][l]())):(t(a={},l,function(){return this}),a),f=d.prototype=u.prototype=Object.create(p);function b(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return c.prototype=d,t(f,"constructor",d),t(d,"constructor",c),c.displayName="GeneratorFunction",t(d,o,"GeneratorFunction"),t(f),t(f,o,"Generator"),t(f,l,function(){return this}),t(f,"toString",function(){return"[object Generator]"}),(e=function(){return{w:i,m:b}})()}function t(e,n,a,r){var l=Object.defineProperty;try{l({},"",{})}catch(e){l=0}t=function(e,n,a,r){function o(n,a){t(e,n,function(e){return this._invoke(n,a,e)})}n?l?l(e,n,{value:a,enumerable:!r,configurable:!r,writable:!r}):e[n]=a:(o("next",0),o("throw",1),o("return",2))},t(e,n,a,r)}function n(e,t,n,a,r,l,o){try{var i=e[l](o),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(a,r)}function a(e){return function(){var t=this,a=arguments;return new Promise(function(r,l){var o=e.apply(t,a);function i(e){n(o,r,l,i,s,"next",e)}function s(e){n(o,r,l,i,s,"throw",e)}i(void 0)})}}System.register(["./chunk-legacy-CdndQ8Vt.js","./chunk-legacy-DasItt_5.js","./chunk-legacy-Q-yyHZlq.js","./chunk-legacy-fbGsbElz.js","./chunk-legacy-Z6zAF711.js"],function(t,n){"use strict";var r,l,o,i,s,u,c,d,p,f,b,m,v,g,y,h,w,x,P,D,k,_,O,T,j,R,A,C,S,L,N,z,F,W,U;return{setters:[function(e){r=e.d,l=e.r,o=e.a,i=e.o,s=e.b,u=e.g,c=e.j,d=e.m,p=e.l,f=e.u,b=e.T,m=e.i,v=e.h,g=e.Y,y=e.am,h=e.a4,w=e.x,x=e.s,P=e.v,D=e.an,k=e.ao,_=e.k,O=e.n,T=e.R,j=e.V,R=e._},function(e){A=e._},function(e){C=e.i,S=e.u,L=e.a,N=e.l,z=e.b},function(e){F=e._},function(e){W=e.r,U=e.a}],execute:function(){var V={class:"drawer drawer-end h-0 w-0"},E={class:"drawer-content w-0 h-0 absolute"},G={class:"drawer-side"},I={key:0,class:"menu bg-base-200 min-h-full w-80 p-4"},J=r({__name:"index",setup:function(e,t){var n=t.expose,a=l(null),r=l(!1);return n({showDrawer:function(){var e;null===(e=a.value)||void 0===e||e.click(),r.value=!0},closeDrawer:function(){var e;null===(e=a.value)||void 0===e||e.click(),r.value=!1}}),function(e,t){return i(),o("div",V,[t[1]||(t[1]=s("input",{id:"my-drawer-1",type:"checkbox",class:"drawer-toggle"},null,-1)),s("div",E,[s("label",{ref_key:"drawerTriggerRef",ref:a,for:"my-drawer-1"},null,512)]),s("div",G,[t[0]||(t[0]=s("label",{for:"my-drawer-1","aria-label":"close sidebar",class:"drawer-overlay"},null,-1)),r.value?(i(),o("div",I,[c(e.$slots,"content")])):u("",!0)])])}}}),M={class:"fieldset"},q={class:"label"},Q=["placeholder"],Y={class:"fieldset"},$={class:"label",required:""},B=["placeholder"],H={class:"validator-hint hidden"},K={class:"fieldset"},X={class:"label"},Z=["placeholder"],ee={class:"fieldset"},te={class:"label"},ne=["placeholder"],ae={class:"fieldset"},re={class:"label"},le=["placeholder"],oe={class:"btn btn-neutral mt-4",type:"submit"},ie=r({__name:"SinglePerson",props:d({addOnePersonDrawerRef:{},addOnePerson:{type:Function}},{singlePersonData:{required:!0},singlePersonDataModifiers:{}}),emits:["update:singlePersonData"],setup:function(e){var t=p().t,n=f(e,"singlePersonData");return function(a,r){return i(),o("form",{class:"fieldset rounded-box w-xs p-4",onSubmit:r[6]||(r[6]=function(t){return e.addOnePerson(e.addOnePersonDrawerRef,t)})},[s("label",M,[s("span",q,m(v(t)("table.number")),1),b(s("input",{"onUpdate:modelValue":r[0]||(r[0]=function(e){return n.value.uid=e}),type:"text",class:"input validator",placeholder:v(t)("table.number")},null,8,Q),[[g,n.value.uid]])]),s("fieldset",Y,[s("label",$,[y(m(v(t)("table.name")),1),r[7]||(r[7]=s("span",{class:"text-red-500"},"*",-1))]),b(s("input",{"onUpdate:modelValue":r[1]||(r[1]=function(e){return n.value.name=e}),type:"text",class:"input validator",placeholder:v(t)("table.name"),required:"",minlength:"1"},null,8,B),[[g,n.value.name]]),s("p",H,m(v(t)("error.personNameEmpty")),1)]),s("label",K,[s("span",X,m(v(t)("table.department")),1),b(s("input",{"onUpdate:modelValue":r[2]||(r[2]=function(e){return n.value.department=e}),type:"text",class:"input validator",placeholder:v(t)("table.department")},null,8,Z),[[g,n.value.department]])]),s("label",ee,[s("span",te,m(v(t)("table.avatar")),1),b(s("input",{"onUpdate:modelValue":r[3]||(r[3]=function(e){return n.value.avatar=e}),type:"text",class:"input validator",placeholder:v(t)("table.avatar")},null,8,ne),[[g,n.value.avatar]])]),s("label",ae,[s("span",re,m(v(t)("table.identity")),1),b(s("input",{"onUpdate:modelValue":r[4]||(r[4]=function(e){return n.value.identity=e}),type:"text",class:"input validator",placeholder:v(t)("table.identity")},null,8,le),[[g,n.value.identity]])]),s("button",oe,m(v(t)("button.confirm")),1),s("button",{class:"btn btn-ghost mt-1",type:"reset",onClick:r[5]||(r[5]=function(t){return e.addOnePersonDrawerRef.closeDrawer()})},m(v(t)("button.cancel")),1)],32)}}});function se(e){return new Worker(""+new URL("../assets/importExcel.worker-CttQOf2e.js",n.meta.url).href,{name:null==e?void 0:e.name})}function ue(t){var n,r=t.exportInputFileRef,o=p().t,i="./".replace("./","/"),s=h.useToast(),u=new se,c=_(N),d=S().personConfig,f=w(d),b=f.getAllPersonList,m=f.getAlreadyPersonList,v=(n={handleDeletePerson:function(e){d.deletePerson(e)}},[{label:C.global.t("data.number"),props:"uid"},{label:C.global.t("data.name"),props:"name"},{label:C.global.t("data.department"),props:"department"},{label:C.global.t("data.avatar"),props:"avatar",formatValue:function(e){return e.avatar?'<img src="'.concat(e.avatar,'" alt="avatar" style="width: 50px; height: 50px;"/>'):"-"}},{label:C.global.t("data.identity"),props:"identity"},{label:C.global.t("data.isWin"),props:"isWin",formatValue:function(e){return e.isWin?C.global.t("data.yes"):C.global.t("data.no")}},{label:C.global.t("data.operation"),actions:[{label:C.global.t("data.delete"),type:"btn-error",onClick:function(e){n.handleDeletePerson(e)}}]}]),g=l(!1),y=l({uid:"",name:"",department:"",avatar:"",identity:""});function O(){return T.apply(this,arguments)}function T(){return(T=a(e().m(function t(){var n,a;return e().w(function(e){for(;;)switch(e.n){case 0:if("zhCn"!==C.global.locale.value){e.n=2;break}return e.n=1,U("".concat(i,"人口登记表-zhCn.xlsx"));case 1:return n=e.v,e.a(2,n);case 2:return e.n=3,U("".concat(i,"personListTemplate-en.xlsx"));case 3:return a=e.v,e.a(2,a);case 4:return e.a(2)}},t)}))).apply(this,arguments)}function j(e){u&&u.postMessage(e)}function R(e){return A.apply(this,arguments)}function A(){return(A=a(e().m(function t(n){var a,r,l;return e().w(function(e){for(;;)switch(e.n){case 0:return null==c||c.show(),O(),a=j,r=n,e.n=1,O();case 1:l=e.v,a({type:"start",data:r,templateData:l});case 2:return e.a(2)}},t)}))).apply(this,arguments)}function z(){return(z=a(e().m(function t(n){return e().w(function(e){for(;;)switch(e.n){case 0:return u&&(u.onmessage=function(e){if("done"===e.data.type&&(d.resetPerson(),d.addNotPersonList(e.data.data),s.open({message:o("error.importSuccess"),type:"success",position:"top-right"}),F()),"error"===e.data.type){if("not right template"===e.data.message)return void s.open({message:o("error.excelFileError"),type:"error",position:"top-right"});s.open({message:e.data.message||o("error.importFail"),type:"error",position:"top-right"})}null==c||c.hide()}),e.n=1,W(n.target.files[0]);case 1:R(e.v);case 2:return e.a(2)}},t)}))).apply(this,arguments)}function F(){r.value&&(r.value.value="")}return{resetData:function(){d.resetAlreadyPerson()},deleteAll:function(){d.deleteAllPerson()},handleFileChange:function(e){return z.apply(this,arguments)},exportData:function(){for(var e=JSON.parse(JSON.stringify(b.value)),t=0;t<e.length;t++)delete e[t].x,delete e[t].y,delete e[t].id,delete e[t].createTime,delete e[t].updateTime,delete e[t].prizeId,e[t].isWin?e[t].isWin=C.global.t("data.yes"):e[t].isWin=C.global.t("data.no"),e[t].prizeTime=e[t].prizeTime.join(","),e[t].prizeName=e[t].prizeName.join(",");var n=JSON.stringify(e);if(n=n.replaceAll(/uid/g,C.global.t("data.number")).replaceAll(/isWin/g,C.global.t("data.isWin")).replaceAll(/department/g,C.global.t("data.department")).replaceAll(/name/g,C.global.t("data.name")).replaceAll(/identity/g,C.global.t("data.identity")).replaceAll(/prizeName/g,C.global.t("data.prizeName")).replaceAll(/prizeTime/g,C.global.t("data.prizeTime")),(e=JSON.parse(n)).length>0){var a=D.json_to_sheet(e),r=D.book_new();D.book_append_sheet(r,a,"Sheet1"),k(r,"data.xlsx")}},alreadyPersonList:m,allPersonList:b,tableColumnList:v,addOnePerson:function(e,t){t.preventDefault();var n=L([x(y.value)]);n[0].id=P(),d.addOnePerson(n),e.closeDrawer(),y.value={}},addPersonModalVisible:g,singlePersonData:y,downloadTemplate:function(){var e=C.global.t("data.xlsxName"),t="".concat(i).concat(e);fetch(t).then(function(e){return e.blob()}).then(function(t){var n=window.URL.createObjectURL(t),a=document.createElement("a");a.href=n,a.download=e,a.click(),s.open({message:o("error.downloadSuccess"),type:"success",position:"top-right"})})}}}var ce={class:"min-w-1000px"},de={class:"flex gap-3"},pe=["data-tip"],fe={class:""},be={for:"explore"},me=["data-tip"],ve={class:"btn btn-primary btn-sm"};t("default",r({__name:"index",setup:function(e){var t=l(),n=l(),a=l(),r=l(),u=ue({exportInputFileRef:a}),c=u.resetData,d=u.deleteAll,f=u.handleFileChange,b=u.exportData,g=u.addOnePerson,y=u.singlePersonData,h=u.alreadyPersonList,w=u.allPersonList,x=u.tableColumnList,P=u.downloadTemplate,D=p().t;return function(e,l){return i(),o(j,null,[O(z,{ref_key:"resetDataDialogRef",ref:t,title:v(D)("dialog.titleTip"),desc:v(D)("dialog.dialogResetWinner"),"submit-func":v(c)},null,8,["title","desc","submit-func"]),O(z,{ref_key:"delAllDataDialogRef",ref:n,title:v(D)("dialog.titleTip"),desc:v(D)("dialog.dialogDelAllPerson"),"submit-func":v(d)},null,8,["title","desc","submit-func"]),O(J,{ref_key:"addOnePersonDrawerRef",ref:r},{content:T(function(){return[O(ie,{"single-person-data":v(y),"onUpdate:singlePersonData":l[0]||(l[0]=function(e){return R(y)?y.value=e:null}),"add-one-person-drawer-ref":r.value,"add-one-person":v(g)},null,8,["single-person-data","add-one-person-drawer-ref","add-one-person"])]}),_:1},512),s("div",ce,[O(F,{title:v(D)("viewTitle.personManagement")},{buttons:T(function(){return[s("div",de,[s("button",{class:"btn btn-error btn-sm",onClick:l[1]||(l[1]=function(e){return n.value.showDialog()})},m(v(D)("button.allDelete")),1),s("div",{class:"tooltip tooltip-bottom","data-tip":v(D)("tooltip.downloadTemplateTip")},[s("button",{class:"no-underline btn btn-secondary btn-sm",onClick:l[2]||(l[2]=function(){return v(P)&&v(P).apply(void 0,arguments)})},m(v(D)("button.downloadTemplate")),1)],8,pe),s("div",fe,[s("label",be,[s("div",{class:"tooltip tooltip-bottom","data-tip":v(D)("tooltip.uploadExcelTip")},[s("input",{id:"explore",ref_key:"exportInputFileRef",ref:a,type:"file",class:"",style:{display:"none"},accept:".xlsx,.xls",onChange:l[3]||(l[3]=function(){return v(f)&&v(f).apply(void 0,arguments)})},null,544),s("span",ve,m(v(D)("button.importData")),1)],8,me)])]),s("button",{class:"btn btn-error btn-sm",onClick:l[4]||(l[4]=function(e){return t.value.showDialog()})},m(v(D)("button.resetData")),1),s("button",{class:"btn btn-accent btn-sm",onClick:l[5]||(l[5]=function(){return v(b)&&v(b).apply(void 0,arguments)})},m(v(D)("button.exportResult")),1),s("div",null,[s("span",null,m(v(D)("table.luckyPeopleNumber"))+":",1),s("span",null,m(v(h).length),1),l[6]||(l[6]=s("span",null," / ",-1)),s("span",null,m(v(w).length),1)])])]}),_:1},8,["title"]),O(A,{"table-columns":v(x),data:v(w)},null,8,["table-columns","data"])])],64)}}}))}}})}();
